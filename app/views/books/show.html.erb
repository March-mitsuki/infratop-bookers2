<div class="container px-5 px-sm-0">
    <div class="row">
        <div class="col-md-3">
            <%= render "shared/user_info", user: @user, new_book: @new_book %>
        </div>
        <div class="col-md-8 offset-md-1">
            <h2>Book detail</h2>
            <table class="table table-hover table-inverse">
                <tbody>
                    <% if @book.user_id == current_user.id %>
                        <tr>
                            <td>
                                <%= link_to user_path(@book.user_id) do %>
                                    <%= image_tag @book.user.get_profile_image(50,50) %>
                                    <br/>
                                    <%= @book.user.name %>
                                <% end %>
                            </td>
                            <td>
                                <%= link_to book_path(@book.id), class: "text-decoration-none" do %>
                                    <%= @book.title %>
                                <% end %>
                            </td>
                            <td>
                                <%= @book.body %>
                            </td>
                            <td>
                                <%= link_to "Edit", edit_book_path(@book.id), class: "btn btn-sm btn-success" %>
                            </td>
                            <td>
                                <%= link_to "Destroy", book_path(@book.id), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "btn btn-sm btn-danger" %>
                            </td>
                            <% if @book.favorited_by?(current_user) %>
                                <td>
                                    <%= link_to book_favorites_path(@book), data: { turbo_method: :delete }, class: "text-decoration-none" do %>
                                        <i class="fa-solid fa-heart" style="color: red"></i>
                                        <span style="color: red"><%= @book.favorites.count %></span>
                                    <% end %>
                                </td>
                            <% else %>
                                <td>
                                    <%= link_to book_favorites_path(@book), data: { turbo_method: :post }, class: "text-decoration-none" do %>
                                        <i class="fa-regular fa-heart"></i>
                                        <span><%= @book.favorites.count %></span>
                                    <% end %>
                                </td>
                            <% end %>
                            <td>
                                <span>
                                    コメント数:
                                    <%= @book.book_comments.count %>
                                </span>
                            </td>
                        </tr>
                    <% else %>
                        <tr>
                            <td>
                                <%= link_to user_path(@book.user_id) do %>
                                    <%= image_tag @book.user.get_profile_image(50,50) %>
                                    <br/>
                                    <%= @book.user.name %>
                                <% end %>
                            </td>
                            <td>
                                <%= link_to book_path(@book.id), class: "text-decoration-none" do %>
                                    <%= @book.title %>
                                <% end %>
                            </td>
                            <td>
                                <%= @book.body %>
                            </td>
                            <td>
                            <% if @book.favorited_by?(current_user) %>
                                <td>
                                    <%= link_to book_favorites_path(@book), data: { turbo_method: :delete }, class: "text-decoration-none" do %>
                                        <i class="fa-solid fa-heart" style="color: red"></i>
                                        <span style="color: red"><%= @book.favorites.count %></span>
                                    <% end %>
                                </td>
                            <% else %>
                                <td>
                                    <%= link_to book_favorites_path(@book), data: { turbo_method: :post }, class: "text-decoration-none" do %>
                                        <i class="fa-regular fa-heart"></i>
                                        <span><%= @book.favorites.count %></span>
                                    <% end %>
                                </td>
                            <% end %>
                            </td>
                            <td>
                                <span>
                                    コメント数:
                                    <%= @book.book_comments.count %>
                                </span>
                            </td>
                        </tr>
                    <% end %>
                </tbody>
            </table>
        </div>
    </div>
</div>